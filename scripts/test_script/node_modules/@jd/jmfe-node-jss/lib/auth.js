/**
 * @file
 * @author Zeng Tong
 * Created on 2017-09-07.
 */

'use strict';
const crypto = require('crypto');
const utf8 = require('utf8');

function auth(options, accessKey, secretKey) {
    var strToSign = [
        options.method
        , options.headers['content-md5'] || ''
        , options.headers['content-type'] || ''
        , options.headers.date
        , options.uri
    ].join('\n');
    var token = crypto.createHmac('sha1', secretKey)
        .update(utf8.encode(strToSign))
        .digest('base64');
    return 'jingdong ' + accessKey + ':' + token;
}

module.exports = auth;